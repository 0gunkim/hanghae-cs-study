### 036. 파일 시스템과 블록

* 파일 시스템은 물리적 저장 매체를 계층 구조처럼 보이게 하여 논리적 구성과 물리적 구현 간의 분리를 보여준다.  

* 각 프로그램에서는 최상위부터 시작하는 계층 구조를 보여주며,   
  폴더는 다른 폴더와 파일의 이름을 담고 있다. 폴더를 탐색해보면 더 많은 폴더와 파일들이 난타난다.  
  (유닉스 계열 운영체제에서는 폴더 대신 디렉토리라는 용어 사용)
  
   [나의 5주차 팀과제로 이어지는 계층 구조] <img width="1440" alt="스크린샷 2022-08-10 02 53 45" src="https://user-images.githubusercontent.com/92393851/183786962-6678fffe-d026-443e-b7b2-220b60ddacae.png">
  
* 폴더는 조직화된 구조를 제공하고 파일은 실질적인 내용을 담고 있다.  
  따라서 컴퓨터가 보유하는 모든 정보는 파일에 저장되고, 유저는 파일을 통해 정보에 접근한다.   
  (파일에는 데이터 뿐만 아니라 크롬과 같은 프로그램의 실행 파일, 라이브러리, 운영체제 구성 파일 등등이 포함된다)
  
* 파일 시스템은 정보를 관리하면서 애플리케이션이나 운영체제의 나머지 부분이 정보에 접근 가능하도록 하고,   
  파일에 대한 접근이 효율적으로 되도록 하고, 데이터의 물리적인 위치를 파악한다. 

* 파일 시스템 서비스는 가장 낮은 레벨의 시스템 콜을 통해 사용할 수 있으며, 라이브러리를 이용하면 되어 프로그래밍이 쉽다. 

#### 보조 기억 장치 파일 시스템

* 폴더 엔트리는 파일 이름, 크기, 생성되거나 변경된 시간 등의 정보를 담고 있으며 그러한 정보는 파인더/탐색기에서 확인할 수 있다.   
  폴더 엔트리는 또한 파일이 드라이브 어디에 저장되어 있는지에 대한 정보도 담고 있다. 

![IMG_89A560D64EC4-1](https://user-images.githubusercontent.com/92393851/184046317-0f9923dc-b894-4f82-92ab-6f55ba6281be.jpeg)   
  위의 이미지는 하드 드라이브에서 블록 목록을 참조하는 블록들의 구조를 보여준다.   
  같은 파일을 나눠담는 블록들이 실제로 인접해 있지 않을 수도 있다. 

* SSD는 전력 소모가 적고, 안정적이고, 가벼워서 가격이 비쌈에도 대부분의 컴퓨터에서 사용된다.  
  SSD는 탐색기 같은 프로그램에서 보면 전혀 차이가 없지만, 하드 드라이브와는 다른 드라이버를 사용하며, 장치 자체에 파일 위치를 기억하기 위한 코드가 들어있다.   
  이는 SSD 장치의 각 영역이 사용될 수 있는 횟수의 제한 때문이다.  
  SSD 내부 소프트웨어는 각 물리적 블록이 몇 번 사용되었는지 파악하고, 각 블록이 같은 횟수로 사용되도록 데이터를 옮긴다. (웨어 레벨링)
  
* 폴더는 다른 폴더와 파일이 어디에 있는지 정보를 담는 파일이며, 또한 블록이다. 
  파일 시스템은 폴더의 내용을 관리하고, 유지하기 위한 권리를 보유하며, 사용자/애플리케이션가 폴더 내용을 바꾸려면 파일 시스템에 요청을 해야한다 

* 프로그램이 기존 파일에 접근하려고 하면, /Users/bwk/book/book.txt의 경로로 찾게 되는데,  
  폴더를 찾아 들어갈때마다 그 폴더 이하에 있는 파일과 폴더에는 수행되는 검색의 범위가 좁아지기 때문에 효율적이다.   
  
* 프로그램이 새 파일을 생성하려고 할 때는 적절한 폴더에 새로운 엔트리를 넣으면서 이름/날짜 등 정보를 넣고, 크기를 0으로 표시한다. 
  추후에 파일에 데이터가 생기면, 파일 시스템은 충분한 수의 미사용 블록을 찾아서 데이터를 복사해 넣고, 폴더 블록 목록에 그 블록을 삽입하고, 애플리케이션으로 돌아간다.  
  -> 파일 시스템은 모든 블록의 목록을 갖고, 새로운 블록에 대한 요청을 받으면 미사용 블록의 목록에서 가져온 블록으로 만족시킨다. 

### 037. 파일을 휴지통에 넣을때 일어나는 일

* 파일이 제거되면 휴지통으로 이동한다. 파일 폴더 엔트리와 이름은 현재 폴더에서 휴지통으로 복사되고, 원래의 엔트리는 지워진다. 
  '휴지통 비우기'를 하면 휴지통에 있는 엔트리가 지워지고, 블록은 미사용 목록에 추가된다. 하지만 내용은 아직 삭제되지 않았다.   
  그 블록이 미사용 목록에서 꺼내져 새로운 파일에 할당되기 전까지는 삭제된 파일에 할당된 각 블록의 모든 바이트는 아직 그대로 있다. 

* 물리적 블록 단위로 드라이브를 읽는 프로그램이라면, 파일 복구가 가능하다.   
  보안이 중요한 군 조직에서는 블록을 무작위 패턴으로 된 0.1 값을 여러번 덮어서 파일을 제거하기도 하고, 강한 자성으로 하드 디스크의 자성을 없애버리기도 한다. 
  
* 하지만 물리적 파괴도 데이터가 클라우드에 저장되고 있는 경우에는 정보 삭제가 불가능하다. 

* 폴더 엔트리도 비슷하다. 실제로 폴더 엔트리가 재사용되기 전까지 모든 내용은 복원 가능하다. 

#### 다른 파일 시스템

* USB 드라이브와 SD 카드의 플래시 메모리 파일 시스템은 컴퓨터에 연결하면 또 다른 디스크 드라이브로 나타나며, 내장 드라이브와 똑같이 파일을 읽고 쓸 수 있다.  
  유일한 차이점은 접근 속도가 다소 느릴 수 있다는 점이다.  
  
* 소프트웨어는 물리적인 장치가 파일 시스템처럼 보이게 하며, 다양한 운영체제에서도 동일하게 추상화된 폴더와 파일 구조로 나타나게 한다. 
  
* 학교나 회사에서 주로 사용되는 네트워크 파일 시스템은 소프트웨어를 활용하여 다른 컴퓨터의 파일 시스템이 마치 자신의 컴퓨터에 있는 것처럼 접근하게 해준다.  
  윈도우/맥/리눅스에 균일한 인터페이스를 제공함으로써 파일 구조가 로컬 컴퓨터의 파일 시스템처럼 보이게 한다. 
  
* 네트워크 파일 시스템은 백업 용도로도 자주 쓰인다.  
  파일의 이전 버전 여러 개를 다른 위치에 있는 보관용 저장 매체로 복사하여 랜섬 웨어나 화재와 같은 재난에서 데이터를 지킬 수 있다.  
  혹은 RAID (복수 배열 독립 디스크) 기법을 활용하여 디스크 중 하나가 고장나더라도 정보를 복원할 수 있게 하는 오류 수정 알고리즘을 통해 여러 개의 디스크에 데이터를 기록한다.  
  
  
  
  
  
  
  
  
  
  
  
  
